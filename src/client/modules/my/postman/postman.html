<template>
    
    <div class="postman">
        
        <!-- settings template -->
        <template if:true={showSettings}>   
            <div class="settings">
                <h1> Settings </h1>
                <div class="settings--menu">
                    <div class="settings--menuItem" onchange={handleThemeChange}> 
                        <div>Theme</div>
                        <select>
                            <option value="Blue">Blue</option>
                            <option value="Green">Green</option>
                            <option value="Wacky">Wacky</option>
                        </select>
                    </div>
                </div>
                <div class="settings--btn">
                    <input type="button" value="OK" onclick={hideSettingsScreen}/>
                </div>
            </div>
        </template>

        <template if:true={showAboutMe}>   <!-- about me template -->
            <div class="aboutme">
                <div class=aboutme__message>Made with LWC <br/><br/> ~ @aritram1</div>
                <input type="button" value="Ok" class="aboutme__btn" onclick={hideAboutMeScreen}/>
            </div>
        </template>

        <div class="topheaderbar">
            <img src="./resources/lwc.png" class="headermenuicon" onclick={showHeaderLinks}/>
            <div class="headerlinks" onblur={hideHeaderLinks}>
                <div class="headerlink__aboutme" onclick={toggleAboutMeScreen}> <u>A</u>bout Me</div>
                <div class="headerlink__settings" onclick={toggleSettingsScreen}> <u>S</u>ettings</div>
            </div>
            <!-- <div class=topheaderbar__right>
                <img src="./resources/lwc.png" onclick={showHeaderMenu}/>
                <img src="./resources/lwc.png" onclick={showHeaderMenu}/>
            </div> -->
        </div>

        <!-- <div class="topheaderbar">
            <img src="./resources/lwc.png" class="headermenu    icon" onclick={showHeaderMenu}/>
            <div class="headerlinks">
                <div class="headerlink__aboutme" onclick={toggleAboutMeScreen}> About Me</div>
                <div class="headerlink__settings" onclick={toggleSettingsScreen}> Settings</div>
            </div>
            div.right
        </div> -->
        <div class="container">
            <div class="header">
                <a href="https://github.com/aritram1/lwc-rest-explorer">
                    <img src="./resources/lwc.png"/>
                </a>
                <div class="appname">Postman Lite</div>
                <div class="time">{timetaken} ms </div>
            </div> 
            <div class="top">
                <select name="methods" id="methods" onchange={handleRequestTypeChange} class="methodOptions">
                    <option value="GET">GET</option>
                    <option value="POST">POST</option>
                    <!-- <option value="PUT">PUT</option>
                    <option value="DELETE">DELETE</option> -->
                </select>
                <template if:false={endpointBeingEdited}>
                    <input class="top--input" placeholder="api.google.com" type="text" value={endpoint} onchange={handleChange} ondblclick={showAllEndPoints}/>
                </template>
                    
                    <div class="endpoints">
                        <template for:each={allEndpoints} for:item="endpoint">
                            <div class="endpointItem" onclick={showInputBack}
                                                      onmousemove={highlightEndpoints} 
                                                      onmouseout={reverseHighlight}
                                                      key={endpoint.key} >
                                {endpoint.method} - {endpoint.ep} 
                            </div>
                        </template>
                    </div>
                
                <input class="container--button" type="button" value="Submit" name="btnSubmit" onclick={handleSubmit}/>
                <!-- <div></div>
                
                <div></div> -->

                <!-- <template for:each={allEndpoints} for:item="ep">
                    <div class="endpoints">
                        <div key={ep}>{ep}</div>
                    </div>
                </template> -->
                
            </div>

            <!-- <div class="endpoints">
                <template for:each={endpoints} for:item="ep">
                    <div class="endpointItem" key={ep}>
                        {ep}
                    </div>
                </template>
            </div> -->
            
            

            <div class="center">
                <my-postmanoptions 
                    method={method} 
                    endpoint={endpoint}
                    onauthchange = {handleAuthChange}
                    onheaderschange = {handleHeadersChange}
                    onbodychange = {handleBodyChange}>
                </my-postmanoptions>
            </div>
            <div class="bottom">
                <div class="history">
                    <template if:true={history}>
                        <template for:each={history} for:item='endpoint'>
                            <template if:true={endpoint.success}>
                                <li class="history--item" 
                                    key={endpoint.id}
                                    name={endpoint.ep}
                                    success={endpoint.success}
                                    style={endpoint.style}
                                    onclick={handleLineItemClick}
                                    onmouseover={handleHoverIn}
                                    onmouseout={handleHoverOut}>
                                    {endpoint.value}
                                </li>
                            </template>
                            <template if:false={endpoint.success}>
                                <li class="history--item history--item__disabled" 
                                    style={endpoint.style}
                                    key={endpoint.id}
                                    name={endpoint.ep}
                                    success={endpoint.success}
                                    onclick={handleLineItemClick}
                                    onmouseover={handleHoverIn}
                                    onmouseout={handleHoverOut}>
                                    {endpoint.value}
                                </li>
                            </template>
    
                            <div class="tooltip" key={endpoint.id}>
                                Time : {endpoint.timestamp} <br/>
                                Endpoint : {endpoint.ep} <br/>
                                Status : {endpoint.status} <br/>
                                Success : {endpoint.success} <br/>
                                Time taken : {endpoint.responsetime}ms <br/>
                            </div>
                        </template>
                    </template>
                    <template if:false={history}>
                        Historical requests appear here
                    </template>
                </div>
                <div class="response">{response}</div>

                <!-- <div class="footer">
                    <div class="footer__aboutme" onclick={toggleAboutMeScreen}>About Me</div> &nbsp; | &nbsp; 
                    <div class="footer__settings" onclick={toggleSettingsScreen}>Settings</div>
                </div> -->

            </div>
        </div>
    </div>

</template>